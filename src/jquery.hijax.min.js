!function(t){var e={element:"#siteContent",exclude:'[data-hijax="false"]',loadingClass:"hijax-loading",metaClass:"hijax-meta",whitelist:["php","html","htm",""],beforeLoad:function(){},afterLoad:function(){}};t.Hijax=function(a){var n=t.extend({},e,a),o={init:function(){window.history&&history.pushState&&(t(document).on("click","a:not(["+n.exclude+"])",o.linkClick),t(window).bind("popstate",o.windowPop))},linkClick:function(e){var a=t(this).attr("target")||!1,i="_blank"===a||"_parent"===a||"_top"===a?!1:!0,r=t(this).attr("href"),l=r.split("/"),d=""!==l[l.length-1]?l[l.length-1]:l[l.length-2],s=d.substr((~-d.lastIndexOf(".")>>>0)+2),c=window.location.pathname.split("/"),h=""!==c[c.length-1]?c[c.length-1]:c[c.length-2],u=n.whitelist;"#"!==r&&u.indexOf(s)>-1&&i&&d!==h?(e.preventDefault(),o.loadResource(r,!0)):d===h&&e.preventDefault()},loadResource:function(e,a){var i=t("html"),r=n.element,l=t.ajax({type:"GET",url:e,dataType:"html",xhr:function(){var e=new window.XMLHttpRequest;return e.addEventListener("progress",function(e){if(e.lengthComputable){var a=e.loaded/e.total*100;t(document).trigger({type:"hijax.progress",percent:a})}},!1),e}});typeof n.beforeLoad==typeof Function&&n.beforeLoad(),i.addClass(n.loadingClass),t(document).trigger({type:"hijax.progress",percent:0}),l.done(function(n){var i=jQuery.parseHTML(n),l=t(i).find(r).html();t(r).html(l),o.changeMeta(),o.changeHistory(e,a),window.scrollTo(0,0)}),l.complete(function(){typeof n.afterLoad==typeof Function&&n.afterLoad(),i.removeClass(n.loadingClass)})},changeMeta:function(){var e=t("."+n.metaClass);e.each(function(){var e=t(this),a=e.attr("data-tag"),n=e.attr("data-type"),o=e.attr("data-"+n),i=e.attr("data-content");"title"===a?document.title=i:t("head meta["+n+'="'+o+'"]').attr("content",i)})},changeHistory:function(t,e){var a=navigator.userAgent.match(/iPhone|iPad|iPod/i)?t+"#":t,n=document.title,o=o||void 0;e&&history.pushState({url:t},n,a),void 0!==o&&o("send","pageview")},windowPop:function(){o.loadResource(window.location,!1)}};o.init()}}(jQuery);
