!function(t){t(function(){"use strict"})}(jQuery,this),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,r){base=this,base.element=e,base.settings=t.extend({},n,r),base._defaults=n,base._name=a,base._init()}var a="hijax",n={container:"#siteContent",exclude:'[data-hijax="false"]',scrollToTop:!1,scrollToHash:!1,smoothScroll:!1,smoothScrollDuration:1e3,smoothScrollContainer:"",sequenceIn:function(t){t()},sequenceOut:function(t){t()}};t.extend(e.prototype,{_init:function(){var t=this;t.element;return t._check.supports?(t._scroller=null,t.settings.smoothScroll&&t._check.scroller.call(t),t._data={url:{initial:null,previous:null,current:null,target:null},pop:{state:!1,id:null!==history.state?history.state.id:0,direction:""},element:null,ajax:{loading:!1,request:null,response:null,target:"",success:!1}},void t._bindEvents.call(t)):(console.error("Hijax: History support not detected. Aborting."),!1)},_bindEvents:function(){var t=this;jQuery(document).on("click."+a,"a:not("+t.settings.exclude+")",function(e){t._eventSwitch.call(t,"click",e,this)}),jQuery(window).on("popstate."+a,function(e){t._eventSwitch.call(t,"popstate",e,this)}),jQuery(window).on("load."+a,function(){t._eventSwitch.call(t,"load")})},_eventSwitch:function(t,e,a){var n=this;switch(t){case"load":n._event.load.call(n);break;case"click":n._event.click.call(n,e,a);break;case"popstate":n._event.popstate.call(n,e,a);break;case"manual":n._event.manual.call(n)}},_check:{scroller:function(){var t=this,e=0,a=0,n=jQuery(t.settings.smoothScrollContainer);n.length?t._scroller=t.settings.smoothScrollContainer:(window.scrollTo(0,1),e=document.documentElement.scrollTop,a=document.body.scrollTop,1===e?t._scroller="html":1===a&&(t._scroller="body"),window.scrollTo(0,0))},supports:function(){var t=navigator.userAgent;return-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone")?window.history&&"pushState"in window.history:!1},page:function(t,e){var a=t.split("/"),n=a[a.length-1],r="",o=e.split("/"),l=o[o.length-1],i="",s=a.length>o.length?a.length:o.length,c=-1;if("#"===o[0])return!0;for(var u=0,d=s;d>u;u++){var _=a[u]||null,h=o[u]||null;if(_!==h){c=u;break}}return c>-1?c===s-1?(r=n.indexOf("#")>-1?n.substring(0,n.indexOf("#")):n,i=l.indexOf("#")>-1?l.substring(0,l.indexOf("#")):l,r===i?!0:!1):!1:!0},domain:function(t){var e=document.createElement("a");return e.href=t,e.hostname===location.hostname}},_event:{load:function(){var t=this,e=t._data;e.url.initial=window.location.href,e.url.current=window.location.href,null===history.state&&history.replaceState({url:e.url.initial,id:e.pop.id},document.title,e.url.initial)},click:function(t,e){var a=this,n=a._data;if($elem=jQuery(e),target_url=$elem.attr("href"),target_hash=$elem.prop("hash"),target_download=$elem[0].hasAttribute("download"),target_target=$elem.attr("target"),target_state="_blank"===target_target||"_parent"===target_target||"_top"===target_target?!1:!0,current_url=a._data.url.current,is_same_page=a._check.page.call(this,current_url,target_url),is_same_domain=a._check.domain.call(this,target_url),is_same_domain)if(is_same_page)if(target_hash.length){if(!a.settings.scrollToHash)return;var r=jQuery(target_hash).offset().top;t.preventDefault(),jQuery(a._scroller).stop(!0,!0).animate({scrollTop:r},a.settings.smoothScrollDuration),history.pushState({url:n.url.current,id:n.pop.id+1},document.title,target_hash)}else t.preventDefault(),$elem.trigger({type:"samelocation.hijax"});else target_state&&!target_download&&(t.preventDefault(),a._data.element=e,a._data.url.previous=window.location.href,a._data.url.target=target_url,a._data.pop.state=!1,a._history.start_load.call(a))},popstate:function(t,e){var a=this,n=a._data.pop.id,r=history.state.id,o=a._check.page.call(a,a._data.url.current,window.location.href);o||(a._data.element=e,a._data.url.previous=a._data.url.current,a._data.url.target=window.location.href,a._data.pop.state=!0,n>r?a._data.pop.direction="back":r>n&&(a._data.pop.direction="forward"),a._data.pop.id=history.state.id,a._history.start_load.call(a))},manual:function(){var t=this;t._data.element=window,t._data.url.previous=window.location.href,t._data.pop.state=!1,t._history.start_load.call(t)}},_history:{update:function(){var t=this,e=t._data;e.url.current=window.location.href,e.url.target=null},start_load:function(){var t=this,e=function(){t._history.load.call(t)},a=function(){t._data.ajax.loading?t._data.ajax.loading&&t._data.url.target!==t._data.ajax.target&&(null!==t._data.ajax.request&&t._data.ajax.request.abort(),t._data.ajax.loading=!0,t._data.ajax.target=t._data.url.target,jQuery.isFunction(t.settings.sequenceOut)?t.settings.sequenceOut.call(t._data.element,e,n):console.error('Hijax: Setting for "sequenceOut" is not a function. Aborting.')):(t._data.ajax.loading=!0,t._data.ajax.target=t._data.url.target,jQuery.isFunction(t.settings.sequenceOut)?t.settings.sequenceOut.call(t._data.element,e,n):console.error('Hijax: Setting for "sequenceOut" is not a function. Aborting.'))},n={url:{current:t._data.url.current,target:t._data.url.target},element:t._data.element};t._data.pop.state&&(n.direction=t._data.pop.direction),!t.settings.smoothScroll&&t.settings.scrollToTop||t._data.pop.state&&t.settings.scrollToTop?(jQuery(t._scroller).scrollTop(0),a()):t.settings.smoothScroll&&jQuery(t._scroller).scrollTop()>0&&t.settings.scrollToTop?jQuery(t._scroller).stop(!0,!0).animate({scrollTop:0,scrollLeft:0},{duration:t.settings.smoothScrollDuration,complete:a}):a()},load:function(){var e=this;e._data.ajax.target=e._data.url.target,null!==e._data.ajax.target&&(t(e.element).trigger({type:"beforeload.hijax"}),t(e.element).trigger({type:"progress.hijax",percent:0}),e._data.ajax.request=jQuery.ajax({url:e._data.ajax.target,type:"GET",dataType:"html",xhr:function(){var a=new window.XMLHttpRequest;return a.addEventListener("progress",function(a){if(a.lengthComputable){var n=a.loaded/a.total*100;t(e.element).trigger({type:"progress.hijax",percent:n})}},!1),a}}).done(function(a){e._data.ajax.response=a,e._data.ajax.success=!0,t(e.element).trigger({type:"afterload.hijax",response:a}),e._history.end_load.call(e)}).fail(function(){e._data.ajax.success=!1}).always(function(){}))},end_load:function(){var e=this,a=function(){var a=window.location.hash;e._data.ajax.loading=!1,e.settings.scrollToHash&&""!==a&&jQuery(a).length?jQuery(e._scroller).stop(!0,!0).animate({scrollTop:jQuery(a).offset().top},{duration:e.settings.smoothScrollDuration,complete:function(){t(e.element).trigger({type:"completeload.hijax"})}}):t(e.element).trigger({type:"completeload.hijax"})},n=null;e._data.ajax.success&&(e._content.update_container.call(e),e._content.update_title.call(e)),e._data.pop.state||e._history.push.call(e),e._history.analytics.call(e),e._history.update.call(e),n={url:{current:e._data.url.current,previous:e._data.url.previous}},jQuery.isFunction(e.settings.sequenceIn)?e.settings.sequenceIn.call(this,a,n):console.error('Hijax: Setting for "sequenceIn" is not a function. Aborting.')},push:function(){var t=this,e=t._data.url.target,a=t._data.pop.id,n=navigator.userAgent.match(/iPhone|iPad|iPod/i)?e+"#":e;history.pushState({url:e,id:a+1},document.title,n),t._data.pop.id=a+1},analytics:function(){var t=t||void 0;void 0!==t&&t("send","pageview")}},_content:{update_container:function(){var t=this,e=t.settings.container,a=t._data.ajax.response,n=jQuery.parseHTML(a),r=jQuery(e),o=jQuery("<div>").append(n).find(e),l=o.html();r.html(l)},update_title:function(){var t=this,e=(t.settings.container,t._data.ajax.response),a=jQuery.parseHTML(e),n=jQuery(a).filter("title").html();document.title=n}},response:function(){var t=this;return t._data.ajax.response},load:function(t){var e=this,a=e._data.url.current,n=e._check.page(a,t),r=e._check.domain.call(this,t);"string"==typeof t&&!n&&r?(e._data.url.target=t,e._eventSwitch.call(e,"manual")):r||(window.location.href=t)}}),t.fn[a]=function(n){var r=Array.prototype.slice.call(arguments,1),o=null;return this.each(function(){var l=t.data(this,"plugin_"+a);l?"string"==typeof n&&"_"!==n.charAt(0)&&t.isFunction(l[n])&&(o=l[n].apply(l,r)):t.data(this,"plugin_"+a,new e(this,n))}),null!==o?o:this}});
//# sourceMappingURL=jquery.hijax.min.js.map