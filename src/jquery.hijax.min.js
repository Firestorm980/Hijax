!function(t){var e={element:"#hijax-content",exclude:'[data-hijax="false"]',loadingClass:"hijax-loading",metaClass:"hijax-meta",whitelist:["php","html","htm",""],smoothScroll:!0,smoothScrollDuration:750,sequenceOut:function(t){t()},sequenceIn:function(t){t()},beforeLoad:function(){},afterLoad:function(){},loadComplete:function(){}};t.Hijax=function(n){var o,a=t.extend({},e,n),i=!1,r=location.href,l=0,c=null,u=!1,d=r,s=null,f="",h={init:function(){h.checkHistorySupport()&&(t(document).on("click","a:not("+a.exclude+")",h.linkClick),t(window).on("popstate",h.windowPop))},checkHistorySupport:function(){var t=navigator.userAgent;return-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone")?window.history&&"pushState"in window.history:!1},checkSamePage:function(t,e){for(var n=t.split("/"),o=n[n.length-1],a=e.split("/"),i=a[a.length-1],r=n.length>a.length?n.length:a.length,l=-1,c=0,u=r;u>c;c++){var d=n[c]||null,s=a[c]||null;if(d!==s){l=c;break}}if(l>-1){if(l===r-1){var f=o.indexOf("#")>-1?o.substring(0,o.indexOf("#")):o,h=i.indexOf("#")>-1?i.substring(0,i.indexOf("#")):i;return f===h?!0:!1}return!1}return!0},linkClick:function(e){var n=window.location,o=t(this).attr("target")||!1,i="_blank"===o||"_parent"===o||"_top"===o?!1:!0,r=t(this).attr("href"),l=t(this).prop("hash"),c=r.split("/"),u=c[c.length-1],d=u.substr((~-u.lastIndexOf(".")>>>0)+2),f=a.whitelist,p=h.checkSamePage(n.href,r);p?l.length||e.preventDefault():f.indexOf(d)>-1&&i&&(e.preventDefault(),s=e.target,h.loadResource(r,!0))},ajaxRequest:function(e,n){l++;var o=l;c=t.ajax({type:"GET",url:e,dataType:"html",xhr:function(){var e=new window.XMLHttpRequest;return e.addEventListener("progress",function(e){if(e.lengthComputable){var n=e.loaded/e.total*100;t(document).trigger({type:"hijax.progress",percent:n})}},!1),e}}),t(document).trigger({type:"hijax.progress",percent:0}),h.windowScroll(0),c.done(function(i){var r=a.element,c=jQuery.parseHTML(i),u=t(c).find(r).html();o==l&&(t(r).html(u),typeof a.afterLoad==typeof Function&&a.afterLoad(),h.changeMeta(c),h.changeHistory(e,n),h.loadComplete())})},loadResource:function(e,n){var i=function(){h.ajaxRequest(e,n)};if(u)null!==c&&c.abort(),h.ajaxRequest(e,n);else{var r=e;f=d,u=!0,o=!1,typeof a.beforeLoad==typeof Function&&a.beforeLoad(),t("html").addClass(a.loadingClass),typeof a.sequenceOut==typeof Function&&a.sequenceOut(i,s,d,r)}},loadComplete:function(){var e=function(){var e=window.location.hash;typeof a.loadComplete==typeof Function&&a.loadComplete(),t("html").removeClass(a.loadingClass),u=!1,e.length&&h.windowScroll(t(e).offset().top)};d=window.location.href,typeof a.sequenceIn==typeof Function&&a.sequenceIn(e,d,f)},changeMeta:function(e){var n=t(e).filter("title").html(),o=t("."+a.metaClass);o.length&&o.each(function(){var e=t(this),n=e.attr("data-tag"),o=e.attr("data-type"),a=e.attr("data-"+o),i=e.attr("data-content");"title"===n?document.title=i:t("head meta["+o+'="'+a+'"]').attr("content",i)}),t("."+a.metaClass+'[data-tag="title"]').length||(document.title=n)},changeHistory:function(t,e){var n=navigator.userAgent.match(/iPhone|iPad|iPod/i)?t+"#":t,o=document.title,a=a||void 0;e&&(history.pushState({url:t},o,n),i=!0),void 0!==a&&a("send","pageview")},windowPop:function(t){var e=!i&&location.href==r;if(i=!0,!e){{var n=h.checkSamePage(d,window.location.href);window.location.hash}n||(o=!1,s=t.target,h.loadResource(window.location,!1))}},windowScroll:function(e){return a.smoothScroll?(t("html, body").animate({scrollTop:e},a.smoothScrollDuration),!1):void window.scrollTo(0,e)}};return h.init(),{load:function(t){var e=h.checkSamePage(d,t);"string"!=typeof t||e||(s=null,h.loadResource(t,!0))}}}}(jQuery);
