!function(t){var a={element:"#hijax-content",exclude:'[data-hijax="false"]',loadingClass:"hijax-loading",metaClass:"hijax-meta",whitelist:["php","html","htm",""],animationTarget:"#hijax-content",animationIn:{opacity:1},animationInOptions:{duration:300},animationOut:{opacity:0},animationOutOptions:{duration:300},beforeLoad:function(){},afterLoad:function(){}};t.Hijax=function(n){var e=t.extend({},a,n),i=!0,o=void 0!==jQuery.Velocity?!0:!1,l={init:function(){window.history&&history.pushState&&(t(document).on("click","a:not("+e.exclude+")",l.linkClick),t(window).bind("popstate",l.windowPop))},linkClick:function(a){var n=t(this).attr("target")||!1,i="_blank"===n||"_parent"===n||"_top"===n?!1:!0,o=t(this).attr("href"),r=o.split("/"),d=""!==r[r.length-1]?r[r.length-1]:r[r.length-2],u=d.substr((~-d.lastIndexOf(".")>>>0)+2),c=window.location.pathname.split("/"),s=""!==c[c.length-1]?c[c.length-1]:c[c.length-2],m=e.whitelist;"#"!==o&&m.indexOf(u)>-1&&i&&d!==s?(a.preventDefault(),l.loadResource(o,!0)):d===s&&a.preventDefault()},ajaxRequest:function(a,n){var i=t.ajax({type:"GET",url:a,dataType:"html",xhr:function(){var a=new window.XMLHttpRequest;return a.addEventListener("progress",function(a){if(a.lengthComputable){var n=a.loaded/a.total*100;t(document).trigger({type:"hijax.progress",percent:n})}},!1),a}});t(document).trigger({type:"hijax.progress",percent:0}),i.done(function(i){var r=e.element,d=jQuery.parseHTML(i),u=t(d).find(r).html();t(r).html(u),o?t(r).find(e.animationTarget).velocity(e.animationOut,{duration:0}):t(r).find(e.animationTarget).animate(e.animationOut,{duration:0}),l.changeMeta(d),l.changeHistory(a,n),window.scrollTo(0,0)}),i.complete(l.loadComplete)},loadResource:function(a,n){var r=e.animationOutOptions;i=!1,typeof e.beforeLoad==typeof Function&&e.beforeLoad(),r.complete=function(){t("html").addClass(e.loadingClass),l.ajaxRequest(a,n)},o?t(e.animationTarget).velocity(e.animationOut,r):t(e.animationTarget).animate(e.animationOut,r)},loadComplete:function(){var a=e.animationInOptions;typeof e.afterLoad==typeof Function&&e.afterLoad(),a.complete=function(){t("html").removeClass(e.loadingClass)},o?t(e.animationTarget).velocity(e.animationIn,a):t(e.animationTarget).animate(e.animationIn,a)},changeMeta:function(a){var n=t(a).filter("title").html(),i=t("."+e.metaClass);i.length&&i.each(function(){var a=t(this),n=a.attr("data-tag"),e=a.attr("data-type"),i=a.attr("data-"+e),o=a.attr("data-content");"title"===n?document.title=o:t("head meta["+e+'="'+i+'"]').attr("content",o)}),t("."+e.metaClass+'[data-tag="title"]').length||(document.title=n)},changeHistory:function(t,a){var n=navigator.userAgent.match(/iPhone|iPad|iPod/i)?t+"#":t,e=document.title,i=i||void 0;a&&history.pushState({url:t},e,n),void 0!==i&&i("send","pageview")},windowPop:function(t){null===t.originalEvent.state&&i||(i=!1,l.loadResource(window.location,!1))}};return l.init(),{load:function(t){l.loadResource(t,!0)}}}}(jQuery);
